name: Build Psych Engine Linux

on:
  push:
    branches:
      - main
  pull_request:
    branches:
      - main

jobs:
  build-linux:
    runs-on: ubuntu-latest

    steps:
      - name: Checkout Repository
        uses: actions/checkout@v3

      # Instala Haxe
      - name: Setup Haxe
        uses: acts/setup-haxe@v1
        with:
          haxe-version: '4.3.0' # ajuste para a vers√£o do Psych Engine

      - name: Install HaxeFlixel
        run: |
          haxelib install flixel
          haxelib install flixel-tools
          haxelib run flixel-tools setup

      - name: Install Additional Haxe Libraries
        run: |
          haxelib install actuate
          haxelib install hxcpp
          haxelib install lime
          haxelib install openfl
          haxelib install flixel-ui
          haxelib install hscript
          haxelib install linc_luajit
          haxelib install hxCodec
          haxelib install discord_rpc

      - name: Build Linux Target
        run: lime build linux -debug

      - name: Run Game
        run: ./export/linux/bin/PsychEngine